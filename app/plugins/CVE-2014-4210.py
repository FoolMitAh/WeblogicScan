#!/usr/bin/env python
# _*_ coding:utf-8 _*_


import requests

from ..platform import ManageProcessor, Color


headers = {'user-agent': 'ceshi/0.0.1'}

VUL = 'CVE-2014-4210'


@ManageProcessor.plugin_register('CVE-2014-4210')
class CVE20144210(object):
    def process(self, ip, port, scheme):
        return self.run(ip, port, scheme)

    def islive(self, ur, port, scheme):
        url = str(scheme) + '://' + str(ur) + ':' + str(port) + '/uddiexplorer/'
        r = requests.get(url, headers=headers)
        return r.status_code

    def run(self, ip, port, scheme):
        if self.islive(ip, port, scheme) == 200:
            u = str(scheme) + '://' + str(ip) + ':' + str(port) + '/uddiexplorer/'
            print(Color.OKBLUE + '[+]The target Weblogic UDDI module is exposed!\n[+]The path is: {}\n[+]Please verify the SSRF vulnerability!'.format(u) + Color.ENDC)
            return True
        else:
            print(Color.FAIL + "[-]The target Weblogic UDDI module default path does not exist!" + Color.ENDC)
            return False
